# Category

- 类别、方法、属性会在加载二进制代码的时候附加到目标类中
- 不支持添加成员变量，Category的结构体未定义，可通过runtime变相添加
- 如果存在同名方法会覆盖主类方法，方法列表中会存在两个同名方法，Category的方法会在前面默认调用
- 如果多个Category存在相同的方法名，最后一个编译的Category中的方法会在最前面
- **所有方法建议增加前缀**

# +load

- 附加Category到类的工作会先于`+load`方法的执行
- `+load`的执行顺序是先类后分类，而分类的执行顺序是根据编译顺序先后决定的。
- 调用子类的+load之前会先调用父类的`+load`
- 类加载时通过函数指针直接调用，早于main函数
- 仅调用一次

| 调用顺序 | 说明 |
| --- | --- |
| 父类 | |
| 子类 | |
| 分类 | 根据编译的先后顺序调用 |

# +initialize

- 收到消息时调用
- 子类仅调用一次
- 子类未实现，调用父类(`可能多次`)的
- 可被分类覆盖，遵循`编译顺序规则`

| 调用顺序 | 说明 |
| --- | --- |
| 父类 | 未被覆盖时可被子类调用多次 |
| 分类 | 可覆盖父类的方法  |
| 子类 | 若未实现则调用父类 |

# 关联对象/属性

通过runtime增加的属性是有AssociationsManager来统一管理，里面是由一个静态AssociationsHashMap来存储所有的关联对象的。这相当于把所有对象的关联对象都存在一个全局map里面。而map的的key是这个对象的指针地址（任意两个不同对象的指针地址一定是不同的），而这个map的value又是另外一个AssociationsHashMap，里面保存了关联对象的kv对。
- 通过runtime变相添加

# Class Extension

```objc
//没有名字的category，可以当成是私有的类别，支持添加属性
@interface TestModle () //我居然一直不知道是这个，在.m中不是天天这么写么???，真的是最熟悉的陌生人

@end
```
